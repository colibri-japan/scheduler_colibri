$('.modal').modal('hide');
$('.modal-backdrop').remove();

if (window.fullCalendar) {
    window.fullCalendar.batchRendering(function(){
        <% @appointments.each do |appointment| %>
            if (typeof(event) === 'undefined') {
                let event 
            }
            event = window.fullCalendar.getEventById('<%= j "appointment_#{appointment.id}" %>')
            if (event) {
                event.remove()
            }

            if (typeof(renderEvent) === 'undefined') {
                let renderEvent 
            }
            renderEvent = (window.currentResourceType === 'team') || (window.currentResourceType === 'nurse' && ['all', '<%= appointment.nurse_id %>'].includes(window.currentResourceId)) || (window.currentResourceType === 'patient' && ['all', '<%= appointment.patient_id %>'].includes(window.currentResourceId) )                
            if (renderEvent) {
                window.fullCalendar.addEvent($.parseJSON("<%= j render(partial: 'appointments/appointment.json', locals: {appointment: appointment}).html_safe %>"), 'url1')
            }
        <% end %>
    })
}