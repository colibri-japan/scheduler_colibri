<% if @recurring_appointment.errors.any?  %>
  alert("<%= j @recurring_appointment.errors.values.join('; ') %>");


<% else %>
  <% if @deleted_occurrence.present? %>
    alert('サービスがその日のみアップデートされました。');
  <% end %>

  $('.calendar').fullCalendar('removeEvents', '<%= "recurring_#{@original_recurring_appointment.id}" %>');
  $('.patient_calendar').fullCalendar('removeEvents', '<%= "recurring_#{@original_recurring_appointment.id}" %>');
  $('.nurse_calendar').fullCalendar('removeEvents', '<%= "recurring_#{@original_recurring_appointment.id}" %>');
  $('.master-calendar').fullCalendar('removeEvents', '<%= "recurring_#{@original_recurring_appointment.id}" %>');

  $('.modal').modal('hide');

  $('.calendar').fullCalendar(
    'renderEvents', 
    $.parseJSON("<%= j render(partial: 'recurring_appointments/recurring_appointment.json', locals: {recurring_appointment: @recurring_appointment}).html_safe %>"), 
    false
  );

  $('.patient_calendar').fullCalendar(
    'renderEvents', 
    $.parseJSON("<%= j render(partial: 'recurring_appointments/recurring_appointment.json', locals: {recurring_appointment: @recurring_appointment}).html_safe %>"), 
    false
  );


  $('.nurse_calendar').fullCalendar(
    'renderEvents', 
    $.parseJSON("<%= j render(partial: 'recurring_appointments/recurring_appointment.json', locals: {recurring_appointment: @recurring_appointment}).html_safe %>"), 
    false
  );


  $('.master-calendar').fullCalendar(
    'renderEvents', 
    $.parseJSON("<%= j render(partial: 'recurring_appointments/recurring_appointment.json', locals: {recurring_appointment: @recurring_appointment}).html_safe %>"), 
    false
  );

  $('#planning-activities').prepend("<%= j render partial: 'activities/activity', locals: {activity: @activity} %>");

  $('#recurring-appointment-details').empty();
  <% if @recurring_appointment.master == true %>
    loadMasterAppointmentDetails();
  <% else %>
    loadPatientRecurringAppointments();
    loadNurseRecurringAppointments();
  <% end %>

<% end %>

