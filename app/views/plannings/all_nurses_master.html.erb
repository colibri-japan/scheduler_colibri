<%= javascript_tag do %>
	window.eventSource1 = "<%= j planning_recurring_appointments_url(@planning) %>";
	window.eventSource2 = "<%= j planning_wished_slots_path(@planning, background: true) %>";
	window.resourceUrl = "<%= j corporation_nurses_url(@corporation, format: :json) %>";
	window.selectActionUrl = "<%= j new_planning_recurring_appointment_url(@planning) %>";
	window.defaultView = "<%= j @corporation.default_view %>";
	window.minTime = "<%= j current_user.corporation.business_start_hour %>";
	window.maxTime = "<%= j current_user.corporation.business_end_hour %>";
	window.planningId = "<%= j @planning.id.to_s %>";
	window.firstDay = "<%= j @corporation.default_first_day.to_s %>";
	window.holidays = "<%= j HolidayJp.between((Date.today - 1.year), (Date.today + 1.year)).to_json.html_safe %>"
	window.masterSchedule = 'false';
	window.generalPlanning = 'true';
    window.resourceLabel = '従業員';
    window.clientResourceName = "<%= j client_resource_name(@corporation.business_vertical) %>";
	window.nurseId = "";
	window.patientId = "";
    window.resourceType = 'nurse';
    window.fullcalendarViewOptions = 'agendaDay,timelineWeek';
	window.userIsAdmin = <%= current_user.has_admin_access? %>;
<% end %>


<%= render partial: 'planning_left_menu', locals: {resource_payable_path: planning_all_nurses_payable_path(@planning, params: {m: Date.today.in_time_zone('Tokyo').month, y: Date.today.in_time_zone('Tokyo').year}), view: 'master'} %>

<%= render partial: 'plannings/resources_submenu', locals: {individual_resource: 'false', resource_type: 'nurse', view: 'master'} %>

<div id="detail-container">
  <div id="detail-planning-container">
    <div style="display:flex;justify-content:space-between;margin-bottom: 15px">
      <div id="planning-nurse-information">
	  	<span id="resource-name-wrapper">全従業員</span>
	  </div>
	  <div style='display:flex'>
		<%= select_tag :nurse_resource_filter, grouped_options_for_select(@nurses.group_full_timer_for_select), {prompt: '従業員フィルタ', id: 'nurse_resource_filter', multiple: true, style: 'width:400px'} %>
		<div class="btn btn-colibri-light-gray text-white" style='margin-left:5px' id="availabilities-print"><i class="glyphicon glyphicon-print" style="color:white;font-size:1em"></i>空き情報</div>
	  </div>
    </div>
		<div id="planning-container">
			<div class="master_calendar"></div>
		</div>
  </div>
</div>

<% if current_user.has_admin_access? %>
	<div id="colibri-batch-master-action-button" class="no-print batch-action-button" data-url="<%= new_planning_master_to_schedule_path(@planning) %>">
		<div class="colibri-glyphicon-container">
			<span class="glyphicon glyphicon-pencil batch-action-pencil"></span>
		</div>
	</div>
<% end %>

<%= render 'plannings/nurse_overlap_modal' %>

<%= render 'plannings/master_drag_drop' %>

<div id="availabilities-form" class="modal fade" style='display:none'>
  <div class="modal-dialog">
    <div class="modal-content">
		<div class="modal-header">
			<h1 class="colibri-small-title">空き時間プリント</h1>
			<button type="button" class="close" data-dismiss="modal">&times;</button>
		</div>
		<div class="modal-body">

			<div class='form-group'>
				<%= label_tag :date, "○○日の週", class: 'colibri-form-label-dark' %><span class='required-field'>*</span>
				<%= text_field_tag :date, value=nil, {class: "form-control", id: :availabilities_date} %>
			</div>

			<div class='form-group'>
				<%= label_tag :text, "備考", class: 'colibri-form-label-dark' %>
				<%= text_area_tag :text, value=@corporation.availabilities_default_text, {class: "form-control", id: :availabilities_text, rows: "8"} %>
			</div>
		</div>
		<div class="modal-footer">
			<div class="btn btn-colibri-light" data-dismiss="modal">閉じる</div>
			<div id="confirm-availabilities-print" class="btn btn-info text-white btn-pointer" data-link="<%= nurses_master_availabilities_path(format: :pdf) %>">プリント</div>
		</div>
	</div>
  </div>
</div>




