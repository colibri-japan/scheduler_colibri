$('.modal').modal('hide');

if (window.userHasRestrictedAccess && window.fullCalendar) {
    console.log('restricted nurse and calendar present')
    <% if @completion_report.reportable_type == "Appointment" %>
      let eventToRemove = window.fullCalendar.getEventById('<%= "appointment_#{@completion_report.reportable_id}" %>')
      if (eventToRemove) {
        eventToRemove.remove()
      }

      window.fullCalendar.addEvent($.parseJSON("<%= j render(partial: 'appointments/appointment.json', locals: {appointment: @completion_report.reportable}).html_safe %>"), 'url1')
    <% end %>
}

if (window.location.pathname.includes('completion_reports')) {
    location.reload()
} else {
  if ($('#resource-details-panel').is(':visible')) {
    $('.reports-index-button').click()
  }
  if ($('.activity_back_icon').length > 0) {
    $('.activity_back_icon').click()
    $('.reports-index-button').click()
    if ($('#reports-day-query').length > 0) {
      let day = $('#reports-day-query').val()
      $.getScript(`/completion_reports?day=${day}`)
    }
  }
}