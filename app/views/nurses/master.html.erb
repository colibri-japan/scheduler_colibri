<%= javascript_tag do %>
	window.recurringAppointmentsURL = "<%= j planning_recurring_appointments_url(@planning, nurse_id: @nurse.id) %>";
	window.corporationNursesURL = "<%= j corporation_nurses_url(@corporation, format: :json) %>";
	window.createRecurringAppointmentURL = "<%= j new_planning_recurring_appointment_url(@planning) %>";
	window.userIsAdmin = "<%= j @admin %>";
	window.nurseId = "<%= j @nurse.id.to_s %>";
	window.minTime = "<%= j current_user.corporation.business_start_hour %>";
	window.maxTime = "<%= j current_user.corporation.business_end_hour %>";
	window.defaultView = "<%= j @corporation.default_master_view %>";
	window.masterToSchedule = "<%= j master_to_schedule_path(@planning) %>";
	window.nurseMasterToSchedule = "<%= j nurse_master_to_schedule_path(@planning, @nurse) %>";
	window.planningId = "<%= j @planning.id.to_s %>";
	window.firstDay = "<%= j @corporation.default_first_day.to_s %>";
	window.printDates = "<%= j @printing_option.print_nurse_dates_in_master.to_s %>";
	window.holidays = "<%= j HolidayJp.between((Date.today - 1.year), (Date.today + 1.year)).to_json.html_safe %>"
<% end %>

<div id="planning-menu-container">
	<%= render 'plannings/planning_master_submenu' %>
</div>

<div id="resource-list-container" class="no-print">
	<div id="toggle-patients-nurses-wrapper">
		<input type="checkbox" id="toggle-patients-nurses">
	</div>
	<div id="resource-container"  class="scrollbar-custom colibri-scrollbar-dark">
	  <div id="patients-resource" class="hide-resource no-print">
		<% @patients.group_by_kana.each do |kana, patients| %>
			<div class="nurses-resource-subsection-title"><%= kana %></div>
			<% patients.each do |patient| %>
				<p class="master-list-element colibri-clickable-link list-patient" data-url="<%= planning_patient_master_path(@planning, patient) %>"><%= patient.try(:name) %></p>
			<% end %>
		<% end %>
	  </div>
	  <div id="nurses-resource" class="no-print">
		<% @grouped_nurses.each do |group, nurses| %>
			<div class="nurses-resource-subsection-title"><%= group %></div>
			<% nurses.each do |nurse| %>
				<p class="master-list-element colibri-clickable-link  <%= 'master-element-selected' if nurse == @nurse %>" data-url="<%= planning_nurse_master_path(@planning, nurse) %>"><%= nurse.try(:name) %></p>
			<% end %>
		<% end %>
	  </div>
	</div>

</div>

<div id="detail-container">
	<div id="detail-planning-container">
		<div id="detail-planning-title" class="print-add-margin">
			<div id="planning-nurse-information">
				<div class="planning-nurse-module-title">
					<%= @nurse.try(:name) %>
				</div>
				<div id="address-phone-container" class="font-size-large print-only">
					<% if @nurse.address.present? %>
						<span class="glyphicon glyphicon-home"></span><span class="font-size-large"><%= " #{@nurse.address}  " %></span>
					<% end %>
					<% if @nurse.phone_number.present? %>
						<span class="glyphicon glyphicon-phone"></span><span class="font-size-large"><%= " #{@nurse.phone_number}" %></span>
					<% end %>
				</div>
				<div  id="description-container" class="print-only">
				  <span class="<%= 'no-print' unless @printing_option.print_nurse_description_in_master == true %>">備考：<%= @nurse.try(:description) %></span>
				</div>
				<div id="appointment-comments-container" class="print-only">
		          <div class="<%= 'no-print' unless @printing_option.print_nurse_comments_in_master == true %>">
			        <div class="appointment-comments-title">コメント</div>
			        <div id="appointment-comments"></div>
		          </div>
		        </div>
			</div>
			<div id="activity-show-button-container" class="no-print">
				<div class="btn btn-colibri-light-gray text-white" id="print-button"><i class="glyphicon glyphicon-print" style="color:white"></i> 印刷</div>
				<% if current_user.has_admin_access? %>
					<div class="btn btn-colibri-light-gray text-white" id="master-options"><i class="glyphicon glyphicon-cog" style="color:white; font-size: 1.25em"></i> オプション</div>
				<% end %>
			</div>
		</div>

		<div id="planning-container">
			<div class="master_calendar"></div>
		</div>
		

	</div>
</div>

<div id="modal-master-options" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h1 class="colibri-small-title">マスターオプション</h1>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>

			<div class="modal-body">
				<table class="table">
                    <tbody>
						<tr>
							<td>提供表の予定を読み込み、マスタースケジュールにサービスを自動的に作成する。</td>
							<td><%= link_to '提供表の読み込み', new_planning_scan_path(@planning), class: 'btn btn-success text-white new-scan', remote: true %></td>
						</tr>
					    <tr>
                            <td>「全体スケジュール」内の<%= @nurse.name %>に関するこれまで編集情報は全て削除され、<%= @nurse.name %>のマスタースケジュールが上書きされます。</td>
                            <td><button class="btn btn-warning" id="copy-master-nurse"><%= @nurse.name %>のマスターを反映</button></td>
                        </tr>
                        <tr>
                            <td>「全体スケジュール」のこれまで編集情報は全て削除され、マスタースケジュールが上書きされます。</td>
                            <td><button class="btn btn-warning btn-warning-danger" id="copy-master">マスターを反映</button></td>
                        </tr>
                    </tbody>
                </table>
			</div>
		</div>
	</div>
</div>

<%= render 'plannings/nurse_conflict_days' %>

<div id="drag-drop-master" style="display: none" title="サービスをコピーする">
	<p>下記のサービスの繰り返しが新規マスターサービスとしてセーブされます：</p>
	<div id="drag-drop-master-content"></div>
</div>
