<% if @recurring_appointment.errors.any? %>
  $('#nurse-conflict-days').text("<%= j @recurring_appointment.errors[:base].join('、') + 'のヘルパーが重複してます。' %>")
  $('.modal').modal('hide');
  $('#nurse-conflict-confirm').dialog({
    resizable: false,
    height: 'auto',
    width: 400,
    modal: true,
    buttons: {
      '登録する':function(){
        $(this).dialog('close');
      },
      'キャンセル':function(){
        $(this).dialog('close');
      }
    }
  })
<% else %>

  $('.modal').modal('hide');

  if (typeof calendar === 'undefined') {
    let calendar;
  }
  if ($('.calendar').length > 0) {
    calendar = $('.calendar');
  } else if ($('.patient_calendar').length > 0) {
    calendar = $('.patient_calendar');
  } else if ($('.nurse_calendar').length > 0) {
    calendar = $('.nurse_calendar');
  } else if ($('.master_calendar').length > 0) {
    calendar = $('.master_calendar');
  }

  <% @appointments.each do |appointment| %>
    calendar.fullCalendar(
      'renderEvent', 
      jQuery.parseJSON("<%= j render(partial: 'appointments/appointment.json', locals: {appointment: appointment}).html_safe %>"),
      false
    );

  <% end %>

  if($('#planning-activities').length > 0) {
    $('#planning-activities').prepend("<%= j render partial: 'activities/activity', locals: {activity: @activity} %>");
  }


<% end %>
